# Поддержка LaTeX на сайте

Сайт поддерживает отображение математических формул в формате LaTeX через библиотеку KaTeX.

## Поддерживаемые форматы

### Inline формулы (в строке)
- `$формула$` - например: `$E = mc^2$`
- `\(формула\)` - например: `\(x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}\)`

### Block формулы (отдельный блок)
- `$$формула$$` - например: `$$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$$`
- `\[формула\]` - например: `\[\sum_{i=1}^{n} i = \frac{n(n+1)}{2}\]`

## Где работает

LaTeX формулы обрабатываются автоматически во всех текстовых блоках:

1. **Страницы калькуляторов** (`/[lang]/[category]/[tool]`):
   - `short_answer`
   - `intro_text`
   - `key_points_json`
   - `howto_json`
   - `content_blocks_json`
   - `formula_md`
   - `assumptions_md`
   - `faq_json`
   - `examples_json`

2. **Статические страницы** (`/[lang]/[category]`):
   - `body_blocks_json`
   - Все HTML контентные блоки

3. **Страницы виджетов** (`/[lang]/widget/[tool]`):
   - Все секции `body_blocks_json`

## Примеры использования

### В базе данных (body_blocks_json, formula_md и т.д.)

```html
<p>Формула Эйнштейна: $E = mc^2$</p>

<p>Квадратное уравнение:</p>
$$x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}$$

<p>Интеграл:</p>
\[\int_{0}^{\infty} e^{-x} dx = 1\]
```

### Примеры формул

**Простые:**
- `$x^2 + y^2 = r^2$` → x² + y² = r²
- `$\alpha + \beta = \gamma$` → α + β = γ

**Сложные:**
- `$$\sum_{i=1}^{n} \frac{1}{i^2} = \frac{\pi^2}{6}$$`
- `\[\lim_{n \to \infty} \left(1 + \frac{1}{n}\right)^n = e\]`

**Матрицы:**
```
$$\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}$$
```

## Технические детали

- **Библиотека**: KaTeX (быстрая, SSR-совместимая)
- **Обработка**: Серверная (SSR) через `lib/latex-server.ts`
- **CSS**: Автоматически подключен через `app/globals.css`
- **Ошибки**: При ошибке парсинга формула остаётся как текст (не ломает страницу)

## Ограничения

- Формулы обрабатываются только в HTML контенте (не в коде виджетов)
- Поддерживается стандартный синтаксис LaTeX, поддерживаемый KaTeX
- Некоторые продвинутые команды LaTeX могут не поддерживаться (см. [документацию KaTeX](https://katex.org/docs/supported.html))
